---
id: t-7733
title: "Saved views system — list views + board (N columns) + persistence"
status: open
type: epic
priority: 1
tags: feature,views,board,persistence
created: 2026-02-23T08:03:00Z
---

## Goal

Users can create, save, and switch between views. A view is either a single filtered list or a board (multiple filtered lists as columns). Boards support presets (By Status, By Type, By Priority) and fully custom columns. Views persist per-project in `~/.ramboard/<project>/views.json`.

## Data Model

```typescript
// The atomic unit — a filtered, sorted list of tickets
interface SavedList {
  name: string
  filters: FilterRule[]
  sortField: SortField
  sortDir: 'asc' | 'desc'
}

// A view is either a single list or multiple lists as board columns
interface SavedView {
  id: string
  name: string
  mode: 'list' | 'board'
  // List mode
  list?: SavedList
  // Board mode — columns rendered left-to-right, leftmost wins for multi-match
  columns?: SavedList[]
  // Board-level sort override (applies to all columns when set)
  boardSort?: { field: SortField; dir: 'asc' | 'desc' }
}
```

## Implementation Plan

### Phase 1: Data Layer
1. **Types** — add `SavedList`, `SavedView` to `src/lib/types.ts`
2. **Server persistence** — `server/views.ts`:
   - Read/write `~/.ramboard/<project>/views.json`
   - Project dir name = last path segment of project path
   - Auto-create dir + seed default view on first access
3. **Server routes** — in `server/routes.ts`:
   - `GET /api/projects/:id/views` — list all views
   - `POST /api/projects/:id/views` — create view
   - `PUT /api/projects/:id/views/:viewId` — update view
   - `DELETE /api/projects/:id/views/:viewId` — delete view
4. **Default view** — seeded on first load:
   ```json
   {
     "id": "default",
     "name": "Open & In Progress",
     "mode": "list",
     "list": {
       "name": "Open & In Progress",
       "filters": [{ "field": "status", "op": "any_of", "values": ["open", "in_progress"] }],
       "sortField": "created",
       "sortDir": "desc"
     }
   }
   ```

### Phase 2: View Store
5. **`src/stores/view-store.ts`** (Zustand):
   - `views: SavedView[]` — all views for active project
   - `activeViewId: string` — currently selected view
   - `dirty: boolean` — true when user modified filters/sort since loading view
   - `fetchViews(projectId)` — GET from server
   - `saveView(view)` — POST/PUT to server
   - `deleteView(viewId)` — DELETE from server
   - `setActiveView(viewId)` — switch view, load its filters into filter-store
   - `markDirty()` — called when filter-store changes

### Phase 3: Board Component
6. **`src/components/board-column.tsx`** — single board column:
   - Takes `SavedList` + `allTickets` as props
   - Runs `getFilteredTickets(allTickets, column.filters, sort)` directly (no store)
   - Own virtualizer + scroll container
   - Column header with name + count
   - Reuses `ListRow` component
7. **`src/components/board-view.tsx`** — updated to render N `BoardColumn`s:
   - Reads columns from active view
   - Multi-match resolution: iterate columns left-to-right, first match claims ticket
   - Board-level sort override toggle in header
8. **Presets** — `src/lib/view-presets.ts`:
   - `createStatusBoard(tickets)` → 3 columns (Open, In Progress, Closed)
   - `createTypeBoard(tickets)` → columns per unique type found
   - `createPriorityBoard()` → 4 columns (Urgent, High, Medium, Low)

### Phase 4: View UX
9. **View switcher** — dropdown/tabs in header bar to pick views
10. **Save View** — button in header, saves current state
11. **Add Column** — button on board, adds column with sensible defaults
12. **Column editor** — popover on column header to edit filters/sort/name
13. **Dirty indicator** — dot on view name when modified
14. **URL routing** — `/:projectId/view/:viewId`

## Multi-Match Resolution

Tickets that match multiple board columns appear in the **leftmost matching column only**. Implementation: iterate columns left-to-right, build a `Set<string>` of claimed ticket IDs. Each column filters from `allTickets` then excludes already-claimed IDs.

## Acceptance Criteria

- [ ] Data model: SavedList + SavedView types
- [ ] Server API: CRUD for views per project
- [ ] Persistence: ~/.ramboard/<project>/views.json
- [ ] View store: Zustand, loads/saves, tracks active + dirty
- [ ] Board component: N columns, each independent filtered+virtualized list
- [ ] Multi-column: leftmost match wins
- [ ] Add Column: button with defaults, then customize
- [ ] Board-level sort override
- [ ] Preset boards: By Status, By Type, By Priority
- [ ] View switcher UI
- [ ] Save View: explicit button
- [ ] Dirty indicator
- [ ] URL routing: /:projectId/view/:viewId
- [ ] Default view seeded on first load

## Verification

- [ ] TypeScript compiles clean
- [ ] Can create and switch between list views
- [ ] Can create board with preset columns
- [ ] Can add/remove/customize board columns
- [ ] Views persist across server restart
- [ ] URL routing works with back/forward
- [ ] Board columns independently scrollable and virtualized

## Worktree
- .
