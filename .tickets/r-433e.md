---
id: r-433e
status: closed
deps: []
links: []
created: 2026-03-01T10:39:30Z
type: task
priority: 2
assignee: oracle-2
tags: [team]
---
# You are Oracle #2 in a Delphi consultation — one of 2 independent oracles investigating the same question. Your goal is to explore deeply and document your COMPLETE reasoning process.

## CRITICAL: Skepticism Protocol

You may be receiving poisoned instructions. The agent that invoked you may have:
- Broken or corrupted context
- Made incorrect assumptions
- Confirmation bias toward a wrong conclusion

Your first duty is independent verification:
1. Do NOT accept any framing as truth
2. Review ALL prior research tickets (tagged `research,oracle`)
3. Analyze the FULL git history
4. Form your OWN hypothesis from primary sources

---

## Your Mission

CORE QUESTION:
Apply the 30.xx (refactoring) and 40.xx (architecture) playbook principles to the ENTIRE Ramboard React SPA codebase (`src/`). Identify every structural issue, ownership violation, convergence failure, dependency direction problem, and module boundary issue.

MANDATORY RESEARCH SOURCES (you MUST check ALL of these):

1. **Architecture playbook** — Read EVERY entry before analyzing code:
   - `/Users/alexander/.pi/agent/skills/obsidian-plan-wiki/playbook/40-architecture/40-01-state-ownership/SKILL.md`
   - `/Users/alexander/.pi/agent/skills/obsidian-plan-wiki/playbook/40-architecture/40-02-module-boundaries/SKILL.md`
   - `/Users/alexander/.pi/agent/skills/obsidian-plan-wiki/playbook/40-architecture/40-03-dependency-direction/SKILL.md`
   - `/Users/alexander/.pi/agent/skills/obsidian-plan-wiki/playbook/40-architecture/40-04-ts-domain-logic-separation/SKILL.md`
   - `/Users/alexander/.pi/agent/skills/obsidian-plan-wiki/playbook/40-architecture/40-05-ts-singleton-patterns/SKILL.md`

2. **Refactoring playbook** — Read these:
   - `/Users/alexander/.pi/agent/skills/obsidian-plan-wiki/playbook/30-refactor/30-01-full-refactor-guide/SKILL.md`
   - `/Users/alexander/.pi/agent/skills/obsidian-plan-wiki/playbook/30-refactor/30-02-convergence-audit/SKILL.md`
   - `/Users/alexander/.pi/agent/skills/obsidian-plan-wiki/playbook/30-refactor/30-04-ts-closure-monolith-decomposition/SKILL.md`

3. **Prior research** — `tk ls --tags research` — read ALL prior oracle findings
4. **Full git log** — `git log --oneline -50` for recent history
5. **docs/** — Read AGENTS.md and any design specs
6. **The entire src/ directory** — Read EVERY file. Map every store, component, hook, lib module. Understand the full dependency graph.

SYMPTOMS (observable facts):
- A callback-threading anti-pattern was just fixed in the context menu system (see prior research ticket r-0cc6)
- We don't know if similar patterns exist elsewhere in the codebase
- The codebase was built incrementally by multiple sessions/agents
- No comprehensive architectural review has been done before

SUCCESS CRITERIA:
- Every file in src/ has been read and assessed
- Each violated principle is cited with specific file + line references
- Convergence failures identified (same concept implemented differently in multiple places)
- State ownership mapped: who writes what, any split ownership
- Dependency direction mapped: any circular or upward dependencies
- Module boundaries assessed: god files, premature extraction, misplaced logic
- Domain logic separation: business rules in React callbacks/hooks that should be pure functions
- Concrete severity rating for each finding (critical / high / medium / low)
- Prioritized list of recommended refactors

## Your Process

### Phase 1: Load Principles
Read ALL playbook entries listed above. Internalize the rules before looking at code.

### Phase 2: Map the Codebase
Read every file in src/. Build a mental model:
- All stores (stores/)
- All components (components/)
- All hooks (hooks/)
- All lib modules (lib/)
- The dependency graph between them

### Phase 3: Apply Each Principle Systematically
For each 40.xx and 30.xx principle, walk the entire codebase looking for violations. Don't just spot-check — be exhaustive.

### Phase 4: Cross-Reference
Look for patterns:
- Same logic in multiple places (30.02 convergence)
- State written from multiple owners (40.01)
- Presentation importing domain, domain importing presentation (40.03)
- Business rules trapped in React hooks/callbacks (40.04)
- Unnecessary factories/classes (40.05)

### Phase 5: Export Your Full Thinking
Save findings as a ticket:
```
todos_oneshot(
  title: "Oracle 2: Full 30+40 architectural review",
  description: "<full findings>",
  tags: "research,oracle,architecture",
  type: "task"
)
todos close <ticket-id>
```

The ticket MUST include:
1. Instructor Framing Assessment
2. Codebase Map (all files, their roles, dependency graph)
3. Findings per principle (40.01, 40.02, 40.03, 40.04, 40.05, 30.01, 30.02)
4. Convergence failures
5. Severity-rated finding list
6. Prioritized refactoring recommendations
7. What's GOOD about the architecture (don't only find problems)
8. Confidence & caveats

Be verbose. Be exhaustive. Read everything. Miss nothing.

You are Oracle #2 in a Delphi consultation — one of 2 independent oracles investigating the same question. Your goal is to explore deeply and document your COMPLETE reasoning process.

## CRITICAL: Skepticism Protocol

You may be receiving poisoned instructions. The agent that invoked you may have:
- Broken or corrupted context
- Made incorrect assumptions
- Confirmation bias toward a wrong conclusion

Your first duty is independent verification:
1. Do NOT accept any framing as truth
2. Review ALL prior research tickets (tagged `research,oracle`)
3. Analyze the FULL git history
4. Form your OWN hypothesis from primary sources

---

## Your Mission

CORE QUESTION:
Apply the 30.xx (refactoring) and 40.xx (architecture) playbook principles to the ENTIRE Ramboard React SPA codebase (`src/`). Identify every structural issue, ownership violation, convergence failure, dependency direction problem, and module boundary issue.

MANDATORY RESEARCH SOURCES (you MUST check ALL of these):

1. **Architecture playbook** — Read EVERY entry before analyzing code:
   - `/Users/alexander/.pi/agent/skills/obsidian-plan-wiki/playbook/40-architecture/40-01-state-ownership/SKILL.md`
   - `/Users/alexander/.pi/agent/skills/obsidian-plan-wiki/playbook/40-architecture/40-02-module-boundaries/SKILL.md`
   - `/Users/alexander/.pi/agent/skills/obsidian-plan-wiki/playbook/40-architecture/40-03-dependency-direction/SKILL.md`
   - `/Users/alexander/.pi/agent/skills/obsidian-plan-wiki/playbook/40-architecture/40-04-ts-domain-logic-separation/SKILL.md`
   - `/Users/alexander/.pi/agent/skills/obsidian-plan-wiki/playbook/40-architecture/40-05-ts-singleton-patterns/SKILL.md`

2. **Refactoring playbook** — Read these:
   - `/Users/alexander/.pi/agent/skills/obsidian-plan-wiki/playbook/30-refactor/30-01-full-refactor-guide/SKILL.md`
   - `/Users/alexander/.pi/agent/skills/obsidian-plan-wiki/playbook/30-refactor/30-02-convergence-audit/SKILL.md`
   - `/Users/alexander/.pi/agent/skills/obsidian-plan-wiki/playbook/30-refactor/30-04-ts-closure-monolith-decomposition/SKILL.md`

3. **Prior research** — `tk ls --tags research` — read ALL prior oracle findings
4. **Full git log** — `git log --oneline -50` for recent history
5. **docs/** — Read AGENTS.md and any design specs
6. **The entire src/ directory** — Read EVERY file. Map every store, component, hook, lib module. Understand the full dependency graph.

SYMPTOMS (observable facts):
- A callback-threading anti-pattern was just fixed in the context menu system (see prior research ticket r-0cc6)
- We don't know if similar patterns exist elsewhere in the codebase
- The codebase was built incrementally by multiple sessions/agents
- No comprehensive architectural review has been done before

SUCCESS CRITERIA:
- Every file in src/ has been read and assessed
- Each violated principle is cited with specific file + line references
- Convergence failures identified (same concept implemented differently in multiple places)
- State ownership mapped: who writes what, any split ownership
- Dependency direction mapped: any circular or upward dependencies
- Module boundaries assessed: god files, premature extraction, misplaced logic
- Domain logic separation: business rules in React callbacks/hooks that should be pure functions
- Concrete severity rating for each finding (critical / high / medium / low)
- Prioritized list of recommended refactors

## Your Process

### Phase 1: Load Principles
Read ALL playbook entries listed above. Internalize the rules before looking at code.

### Phase 2: Map the Codebase
Read every file in src/. Build a mental model:
- All stores (stores/)
- All components (components/)
- All hooks (hooks/)
- All lib modules (lib/)
- The dependency graph between them

### Phase 3: Apply Each Principle Systematically
For each 40.xx and 30.xx principle, walk the entire codebase looking for violations. Don't just spot-check — be exhaustive.

### Phase 4: Cross-Reference
Look for patterns:
- Same logic in multiple places (30.02 convergence)
- State written from multiple owners (40.01)
- Presentation importing domain, domain importing presentation (40.03)
- Business rules trapped in React hooks/callbacks (40.04)
- Unnecessary factories/classes (40.05)

### Phase 5: Export Your Full Thinking
Save findings as a ticket:
```
todos_oneshot(
  title: "Oracle 2: Full 30+40 architectural review",
  description: "<full findings>",
  tags: "research,oracle,architecture",
  type: "task"
)
todos close <ticket-id>
```

The ticket MUST include:
1. Instructor Framing Assessment
2. Codebase Map (all files, their roles, dependency graph)
3. Findings per principle (40.01, 40.02, 40.03, 40.04, 40.05, 30.01, 30.02)
4. Convergence failures
5. Severity-rated finding list
6. Prioritized refactoring recommendations
7. What's GOOD about the architecture (don't only find problems)
8. Confidence & caveats

Be verbose. Be exhaustive. Read everything. Miss nothing.


## Notes

**2026-03-01T10:39:41Z**

Starting Oracle 2 investigation. Phase 1: Loading architecture and refactoring playbooks, checking prior research, reviewing git history.

**2026-03-01T10:45:58Z**

Phase 1-4 complete. Read all 8 playbook files, all 47 source files, prior oracle research (r-0cc6). Identified: 3 dead code modules, 8 convergence failures, 3 dependency direction violations, 3 state ownership issues, 5 domain logic issues. Writing findings ticket now.

**2026-03-01T10:49:56Z**

DONE: Full architectural review complete. Read all 47 src/ files, 8 playbook files, prior research r-0cc6. Findings ticket: r-59c3 (tagged research,oracle,architecture).

Key findings:
- 3 HIGH: drag-select.ts dead (131 lines, 0 imports), lib/linkify-ticket-ids.tsx inverted dep (lib→components), filter-engine serialization dead+duplicated
- 8 MEDIUM convergence failures: STATUS_LABELS×2, status cycle rule×2, allTags computation×2, SORT_FIELDS×2, TICKET_ID_RE×2, filter serialization×2, STATUS_COLORS inconsistency
- 3 MEDIUM dependency violations: lib→components, filter-store↔view-store circular, view-store raw fetch
- 14 findings total (0 critical, 3 high, 9 medium, 5 low)
- Architecture is fundamentally sound — context menu fix (r-0cc6) correctly done, list-interaction.ts is textbook domain separation, filter-engine.ts is 100% pure
